<ion-header [translucent]="true">
  <ion-toolbar>
    <ion-title>eFootball Team Manager</ion-title>
    <ion-buttons slot="end">
      <ion-button *ngIf="hasAlerts()" fill="clear" color="danger">
        <ion-icon name="notifications-outline"></ion-icon>
      </ion-button>
      <ion-button fill="clear" (click)="openProfile()">
        <ion-icon name="person-circle"></ion-icon>
      </ion-button>
    </ion-buttons>
  </ion-toolbar>
</ion-header>

<ion-content [fullscreen]="true">
  <ion-header collapse="condense">
    <ion-toolbar>
      <ion-title size="large">Home</ion-title>
    </ion-toolbar>
  </ion-header>

  <!-- Pull to refresh -->
  <ion-refresher slot="fixed" (ionRefresh)="doRefresh($event)">
    <ion-refresher-content
      pullingIcon="refresh-outline"
      pullingText="Puxe para atualizar"
      refreshingSpinner="circles"
      refreshingText="Atualizando...">
    </ion-refresher-content>
  </ion-refresher>

  <!-- Loading skeleton -->
  <div *ngIf="isLoading" class="loading-container">
    <ion-card class="team-card">
      <ion-card-content>
        <div class="team-header">
          <div class="team-info">
            <ion-skeleton-text animated style="width: 60%; height: 24px; margin-bottom: 8px;"></ion-skeleton-text>
            <ion-skeleton-text animated style="width: 40%; height: 16px; margin-bottom: 4px;"></ion-skeleton-text>
            <ion-skeleton-text animated style="width: 30%; height: 14px;"></ion-skeleton-text>
          </div>
          <ion-skeleton-text animated style="width: 80px; height: 40px; border-radius: 8px;"></ion-skeleton-text>
        </div>
      </ion-card-content>
    </ion-card>
  </div>

  <!-- Main content -->
  <div *ngIf="!isLoading">
    <!-- Alerts section -->
    <div *ngIf="hasAlerts()" class="alerts-section">
      <app-alert-card 
        *ngFor="let alert of alerts" 
        [alert]="alert"
        (dismiss)="onAlertDismiss($event)"
        (action)="onAlertAction($event)">
      </app-alert-card>
    </div>

    <!-- Team info card -->
    <ion-card class="team-card" *ngIf="team">
      <ion-card-content>
        <div class="team-header">
          <div class="team-info">
            <h1>{{ team.name }}</h1>
            <p class="admin-info">ADM: {{ team.adminName }}</p>
            <p class="modality">{{ team.modality }}</p>
          </div>
          <ion-button 
            fill="outline" 
            size="small" 
            (click)="editTeam()"
            class="edit-button">
            <ion-icon name="create" slot="start"></ion-icon>
            Editar
          </ion-button>
        </div>
      </ion-card-content>
    </ion-card>

    <!-- Quick stats section -->
    <div class="section-title">Estatísticas Rápidas</div>
    <ion-grid class="stats-grid">
      <ion-row>
        <ion-col size="6" *ngFor="let stat of getQuickStats()">
          <app-card-estatistica
            [icon]="stat.icon"
            [value]="stat.value"
            [label]="stat.label"
            [color]="stat.color"
            [trend]="stat.trend">
          </app-card-estatistica>
        </ion-col>
      </ion-row>
    </ion-grid>

    <!-- Performance chart -->
    <app-grafico-aproveitamento 
      *ngIf="team?.stats"
      [stats]="team?.stats || null"
      title="Aproveitamento do Time">
    </app-grafico-aproveitamento>

    <!-- Top player highlight -->
    <ion-card *ngIf="statsSummary?.topPlayer" class="top-player-card">
      <ion-card-header>
        <ion-card-title>Destaque do Time</ion-card-title>
      </ion-card-header>
      <ion-card-content>
        <div class="player-highlight">
          <div class="player-avatar">
            <ion-icon name="person" size="large"></ion-icon>
          </div>
          <div class="player-info">
            <h3>{{ statsSummary?.topPlayer?.name }}</h3>
            <p class="player-nickname">{{ statsSummary?.topPlayer?.nickname }}</p>
            <p class="player-position">{{ statsSummary?.topPlayer?.position }}</p>
          </div>
          <div class="player-performance">
            <div class="performance-badge">
              <span class="performance-value">{{ statsSummary?.topPlayer?.stats?.winRate }}%</span>
              <span class="performance-label">Aproveitamento</span>
            </div>
            <p class="matches-info">{{ statsSummary?.topPlayer?.stats?.totalMatches }} jogos</p>
          </div>
        </div>
      </ion-card-content>
    </ion-card>

    <!-- Actions grid -->
    <div class="section-title">Ações Rápidas</div>
    <ion-grid class="actions-grid">
      <ion-row>
        <ion-col size="4" *ngFor="let action of actions">
          <div class="action-item" (click)="navigateTo(action.route)">
            <div class="action-icon" [style.background]="'var(--ion-color-' + action.color + ')'">
              <ion-icon [name]="action.icon"></ion-icon>
            </div>
            <p class="action-label">{{ action.label }}</p>
          </div>
        </ion-col>
      </ion-row>
    </ion-grid>
  </div>
</ion-content>

